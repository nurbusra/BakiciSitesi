<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      template="/template/enhancedTemplate.xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    
    <ui:define name="content">
        <h2>İlan Bilgileri</h2> <br/><br/>
        
        <h:form id="bakici_control" 
                rendered="#{
                    (sessionBean.entity.sinif == 0) or sessionBean.entity.sinif == 1 and 
                    sessionBean.childBakici.bakici_id == ilanBean.entity.bakici.bakici_id
                            }"> <!-- Ziyaretçi SU ise ya da İlanın sahibi ise form görüntülenir. -->
            
            <h:commandButton rendered="#{ilanBean.entity.aktif}" value="Deactivate" action="#{ilanBean.updateEntity}">
                <f:actionListener binding="#{ilanBean.entity.setAktif(false)}"/>
            </h:commandButton>
            <h:commandButton rendered="#{! ilanBean.entity.aktif}" value="Activate" action="#{ilanBean.updateEntity}">
                <f:actionListener binding="#{ilanBean.entity.setAktif(true)}"/>
            </h:commandButton>
            
        </h:form>
        
        <h:form id="musteri_control" 
                rendered="#{
                    sessionBean.entity.sinif == 0 or (
                    sessionBean.entity.sinif == 2 and
                    sessionBean.
                        childMusteri.
                            checkBasvuru(
                                sessionBean.childMusteri.musteri_id, ilanBean.entity.ilan_id
                            ) 
                            == false )
                            }"> <!-- Ziyaretçi SU ise ya da Müşteri ise form görüntülenir. -->
            
            <h:commandButton styleClass="btn btn-success" rendered="#{ilanBean.entity.aktif}" 
                             value="Başvur" 
                             action="/ilan.xhtml">
                <f:actionListener binding="#{musterixilanBean.basvur(sessionBean.childMusteri.musteri_id, ilanBean.entity.ilan_id)}"/>
                <f:actionListener binding="#{sessionBean.childMusteri.updateBasvuruList(sessionBean.childMusteri.musteri_id)}"/>
            </h:commandButton>
            
        </h:form>
        
        <br />
        <div>Ilan ID: #{ilanBean.entity.ilan_id}</div>
        <br />
        <div>Aciklama: #{ilanBean.entity.aciklama}</div>
        <br />
        <div>Bakici ID: #{ilanBean.entity.bakici_id}</div>
        <br />
        <div>Ucret: #{ilanBean.entity.ucret}</div>
        <br />
        <div>Aktif: #{ilanBean.entity.aktif}</div>
        <br />
         
    </ui:define>
</ui:composition>
